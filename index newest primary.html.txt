<!doctype html>
<html lang="uk">
<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="icon" href="/icons/favicon.ico" sizes="any">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
  <link rel="manifest" href="/icons/site.webmanifest">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#39ff14">
  <meta name="msapplication-TileColor" content="#0b1416">
  <meta name="theme-color" content="#0b1416">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <link rel="icon" href="favicon_francuz1k.ico" type="image/x-icon" />
  <title>Francuz1k ‚Äî Giveaway Portal</title>
  <style>
    :root{ --neon:#00ffaa; --neon2:#00ff99; --bg1:#0b1416; --bg2:#020404; }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html{background:#000;height:100%;width:100%}
    body{
      margin:0;color:#c8fddf;font-family:'Segoe UI',system-ui,sans-serif;text-align:center;
      min-height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden;
      background:#000;padding:40px 16px;
      padding-top:env(safe-area-inset-top);padding-bottom:env(safe-area-inset-bottom);
    }
    .button.no-pulse { animation: none !important; }

    /* ===== –ù–ï–û–ù–û–í–ò–ô –§–û–ù ===== */
    .bg,.bg:before,.bg:after{
      position:fixed;inset:-20vmax;content:"";z-index:-1;pointer-events:none;
      background:
        radial-gradient(40vmax 40vmax at 30% 35%, rgba(0,255,170,.18), transparent 60%),
        radial-gradient(35vmax 35vmax at 70% 60%, rgba(0,255,153,.14), transparent 60%),
        radial-gradient(25vmax 25vmax at 50% 80%, rgba(0,255,170,.10), transparent 60%),
        radial-gradient(120vmax 120vmax at 50% 40%, var(--bg1), var(--bg2) 55%);
      filter:blur(6px) saturate(110%);
    }
    .bg{animation:float1 18s ease-in-out infinite;}
    .bg:before{animation:float2 22s ease-in-out infinite;mix-blend-mode:screen;opacity:.7}
    .bg:after {animation:float3 26s ease-in-out infinite;mix-blend-mode:screen;opacity:.55}
    @keyframes float1{0%,100%{transform:translate3d(-2%,-1%,0)}50%{transform:translate3d(2%,2%,0)}}
    @keyframes float2{0%,100%{transform:translate3d(3%,-2%,0)}50%{transform:translate3d(-3%,3%,0)}}
    @keyframes float3{0%,100%{transform:translate3d(-1%,3%,0)}50%{transform:translate3d(1%,-3%,0)}}

    .wrap{width:min(720px,94vw);display:flex;flex-direction:column;align-items:center;animation:fadeIn .8s ease-out both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

    h1{font-size:clamp(1.8em,5vw,2.6em);margin:.2em 0 .4em;
      text-shadow:0 0 12px color-mix(in srgb,var(--neon)50%,transparent),0 0 35px color-mix(in srgb,var(--neon)25%,transparent);}
    p{color:#90bfa3;margin:.3em 0 2em;font-size:clamp(1em,3vw,1.2em);line-height:1.45}

    .buttons{display:flex;flex-direction:column;gap:18px;width:100%;max-width:320px}
    a.button{
      background:#030806;color:#00ffbb;padding:14px 26px;border-radius:12px;font-weight:700;
      text-decoration:none;font-size:1.05em;display:flex;align-items:center;justify-content:center;gap:10px;width:100%;
      border:1px solid color-mix(in srgb,var(--neon)25%,transparent);
      box-shadow:0 0 15px rgba(0,255,136,.33),inset 0 0 8px rgba(0,255,136,.4);
      transition:transform .2s ease,box-shadow .2s ease,background .2s ease,color .2s ease;
      animation:pulse 3s ease-in-out infinite;
    }
    a.button:hover{
      transform:scale(1.04);
      background:linear-gradient(90deg,var(--neon),var(--neon2));
      color:#000; box-shadow:0 0 25px var(--neon), inset 0 0 12px rgba(0,255,170,.5);
    }
    @keyframes pulse{
      0%,100%{box-shadow:0 0 15px rgba(0,255,136,.33), inset 0 0 8px rgba(0,255,136,.4)}
      50%{box-shadow:0 0 25px var(--neon), inset 0 0 10px rgba(0,255,170,.55)}
    }

    svg.icon{width:24px;height:24px;filter:drop-shadow(0 0 3px rgba(0,255,204,.9))}
    footer{margin-top:7vh;color:#6f8f7a;font-size:.85em;text-align:center}

    /* Kick icon ‚Äî —á–∏—Å—Ç–∏–π –Ω–µ–æ–Ω */
    svg.icon.kick{width:28px;height:28px;filter:
      drop-shadow(0 0 3px #00ff55)
      drop-shadow(0 0 8px #00ff77)
      drop-shadow(0 0 15px rgba(0,255,100,.55));}
    a.button:hover svg.icon.kick{filter:
      drop-shadow(0 0 6px #00ff77)
      drop-shadow(0 0 14px #00ffaa);}

    /* –ø—Ä–∞–ø–æ—Ä—Ü—ñ */
    .lang-switch{
      position:fixed;top:20px;right:25px;z-index:9999;display:flex;gap:10px;
      background:rgba(3,8,6,.55);border:1px solid rgba(0,255,170,.25);border-radius:14px;padding:8px 10px;
      backdrop-filter:blur(6px);
      box-shadow:0 0 20px rgba(0,255,170,.35), inset 0 0 10px rgba(0,255,136,.3);
      animation:glow 4s ease-in-out infinite;
    }
    @keyframes glow{
      0%,100%{box-shadow:0 0 14px rgba(0,255,170,.25), inset 0 0 6px rgba(0,255,136,.25)}
      50%{box-shadow:0 0 28px var(--neon), inset 0 0 10px rgba(0,255,170,.45)}
    }
    .flag-btn{background:transparent;border:none;cursor:pointer;border-radius:10px;padding:5px 8px;}
    .flag-btn svg{width:28px;height:20px;border-radius:4px;}
    .flag-btn[aria-pressed="true"]{
      background:linear-gradient(90deg,var(--neon),var(--neon2));box-shadow:0 0 12px var(--neon);transform:scale(1.05);}
    .flag-btn:hover{transform:scale(1.08);}

    /* SVG —É –∫–Ω–æ–ø–∫–∞—Ö –∑–∞–≤–∂–¥–∏ –≤–∏–¥–Ω–æ */
    svg.icon { display:block; flex-shrink:0; }

    @media (prefers-reduced-motion: reduce){
      .bg,.bg:before,.bg:after{animation:none}
      a.button{animation:none}
      .wrap{animation:none}
      .lang-switch{animation:none}
    }
  </style>
</head>
<body>
  <div class="lang-switch" role="group" aria-label="Language">
    <button class="flag-btn" id="btn-en" aria-pressed="false" title="English">
      <svg viewBox="0 0 60 30"><rect width="60" height="30" fill="#012169"/>
        <path d="M0,0 60,30 M60,0 0,30" stroke="#fff" stroke-width="6"/>
        <path d="M0,0 60,30 M60,0 0,30" stroke="#C8102E" stroke-width="4"/>
        <path d="M30,0 v30 M0,15 h60" stroke="#fff" stroke-width="10"/>
        <path d="M30,0 v30 M0,15 h60" stroke="#C8102E" stroke-width="6"/>
      </svg>
    </button>
    <button class="flag-btn" id="btn-ua" aria-pressed="true" title="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞">
      <svg viewBox="0 0 4 3"><rect width="4" height="1.5" fill="#005BBB"/><rect y="1.5" width="4" height="1.5" fill="#FFD500"/></svg>
    </button>
  </div>

  <div class="bg" aria-hidden="true"></div>

  <main class="wrap">
    <h1 id="t-title">üéâ Giveaway –≤—ñ–¥ Francua</h1>
    <p id="t-sub">–ü—ñ–¥–ø–∏—à–∏—Å—å, —â–æ–± –≤–∑—è—Ç–∏ —É—á–∞—Å—Ç—å —É —Ä–æ–∑—ñ–≥—Ä–∞—à—ñ<br>—Ç–∞ –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ —Å—Ç–∞—Ä—Ç –µ—Ñ—ñ—Ä—É!</p>

    <div class="buttons">
      <a href="https://kick.com/francuz000" target="_blank" class="button" id="btn-kick">
        <svg class="icon kick" viewBox="0 0 64 64"><rect x="2" y="2" width="60" height="60" rx="8" fill="#000"/>
          <g transform="scale(0.095) translate(110,110)">
            <path d="M37 .036h164.448v113.621h54.71v-56.82h54.731V.036h164.448v170.777h-54.73v56.82h-54.711v56.8h54.71v56.82h54.73V512.03H310.89v-56.82h-54.73v-56.8h-54.711v113.62H37V.036z" fill="#00ff55"/>
          </g></svg>
        <span id="t-kick">–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ Kick</span>
      </a>

      <a href="https://t.me/Francuz1kbot" target="_blank" class="button" id="btn-telegram">
        <svg class="icon" viewBox="0 0 240 240"><circle cx="120" cy="120" r="120" fill="#0088cc"/>
          <path fill="#fff" d="M97 173c-3 0-2-1-3-4l-8-28 103-61"/>
          <path fill="#fff" d="M97 173c2 0 4-1 6-2l16-15-20-12"/>
          <path fill="#fff" d="M99 144l48 36c5 3 9 1 10-5l18-83c2-7-2-10-7-8L56 123c-7 2-7 6-1 8l26 8 59-37c3-2 6-1 3 1"/>
        </svg>
        <span id="t-telegram">–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ Telegram</span>
      </a>
    </div>

    <footer id="t-foot">¬© 2025 <b>Francuz1k</b> ‚Äî —É—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω–æ</footer>
  </main>

<script>
const I18N={
  en:{
    title:"üéâ Francua Giveaway",
    sub:"Subscribe to join the giveaway<br>and don‚Äôt miss the stream start!",
    kick:"Follow on Kick",
    tg:"Subscribe to Telegram",
    tg_subscribed:"Subscribed Telegram",
    kick_followed:"Followed Kick",
    foot:"¬© 2025 <b>Francuz1k</b> ‚Äî all rights reserved"
  },
  ua:{
    title:"üéâ Giveaway –≤—ñ–¥ Francua",
    sub:"–ü—ñ–¥–ø–∏—à–∏—Å—å, —â–æ–± –≤–∑—è—Ç–∏ —É—á–∞—Å—Ç—å —É —Ä–æ–∑—ñ–≥—Ä–∞—à—ñ<br>—Ç–∞ –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ —Å—Ç–∞—Ä—Ç –µ—Ñ—ñ—Ä—É!",
    kick:"–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ Kick",
    tg:"–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ Telegram",
    tg_subscribed:"–ü—ñ–¥–ø–∏—Å–∞–Ω–æ Telegram",
    kick_followed:"–ü—ñ–¥–ø–∏—Å–∞–Ω–æ Kick",
    foot:"¬© 2025 <b>Francuz1k</b> ‚Äî —É—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω–æ"
  }
};

const el={
  title:document.getElementById('t-title'),
  sub:document.getElementById('t-sub'),
  kick:document.getElementById('t-kick'),
  tg:document.getElementById('t-telegram'),
  foot:document.getElementById('t-foot'),
  btnEn:document.getElementById('btn-en'),
  btnUa:document.getElementById('btn-ua'),
  btnTg:document.getElementById('btn-telegram'),
  btnKick:document.getElementById('btn-kick')
};

// --- –º–æ–≤–∏ ---
function applyLang(lang){
  const d=I18N[lang]||I18N.ua;
  document.documentElement.lang=(lang==='en'?'en':'uk');
  el.title.innerHTML=d.title; el.sub.innerHTML=d.sub;
  el.kick.textContent=d.kick; el.tg.textContent=d.tg; el.foot.innerHTML=d.foot;
  el.btnEn.setAttribute('aria-pressed',String(lang==='en'));
  el.btnUa.setAttribute('aria-pressed',String(lang!=='en'));
  localStorage.setItem('lang',lang);
  // –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –º–æ–≤–∏ –æ–¥—Ä–∞–∑—É –æ–Ω–æ–≤–∏–º–æ —Å—Ç–∞—Ç—É—Å, —â–æ–± –ø—ñ–¥—Ç—è–≥–Ω—É—Ç–∏ –∫–æ—Ä–æ—Ç–∫—ñ —Ç–µ–∫—Å—Ç–∏
  pollStatus(true);
}
applyLang(localStorage.getItem('lang')||'ua');
el.btnEn.addEventListener('click',()=>applyLang('en'));
el.btnUa.addEventListener('click',()=>applyLang('ua'));

// --- –ø–æ–≤–Ω–µ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∫–ª—ñ–∫–∞ (–≤ —Ç.—á. –Ω–∞ iOS)
function disableButton(anchorEl,newText){
  try{
    if(newText){
      const span=anchorEl.querySelector('span');
      if(span) span.textContent=newText;
    }
    anchorEl.removeAttribute('href');
    anchorEl.removeAttribute('target');
    anchorEl.style.pointerEvents='none';     // iOS-safe
    anchorEl.setAttribute('aria-disabled','true');
    anchorEl.setAttribute('tabindex','-1');
    anchorEl.classList.add('no-pulse');
  }catch(_){}
}

// --- —Å—Ç–≤–æ—Ä—é—î–º–æ —É—á–∞—Å–Ω–∏–∫–∞ –ª–∏—à–µ 1 —Ä–∞–∑
(async function(){
  try{
    let pid = localStorage.getItem('pid');
    let tgStart = localStorage.getItem('tg_start');

    if (!pid) {
      const r = await fetch('/api/join/start',{method:'POST'});
      const j = await r.json(); if(!j.ok) return;
      pid = String(j.participant_id);
      tgStart = j.tg_start;
      localStorage.setItem('pid', pid);
      localStorage.setItem('tg_start', tgStart);
    }
    if (tgStart) {
      const link=`https://t.me/Francuz1kbot?start=${encodeURIComponent(tgStart)}`;
      el.btnTg.setAttribute('href',link);
    }
    // NEW: –ø—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è pid ‚Äî –Ω–∞–ø—Ä–∞–≤–ª—è—î–º–æ –∫–Ω–æ–ø–∫—É Kick —á–µ—Ä–µ–∑ –±–µ–∫–µ–Ω–¥, —è–∫–∏–π –∑–∞–ø—É—Å–∫–∞—î OAuth
    if (pid) {
      el.btnKick.setAttribute('href', `/api/kick/connect?pid=${encodeURIComponent(pid)}`);
      el.btnKick.setAttribute('target', '_self'); // —â–æ–± –Ω–µ –ª–∞–º–∞—Ç–∏ OAuth-—Ä–µ–¥—ñ—Ä–µ–∫—Ç –±–ª–æ–∫–µ—Ä–∞–º–∏ –ø–æ–ø–∞–ø—ñ–≤
    }
  }catch(e){ console.warn('join/start failed',e); }
})();

// --- —Å—Ç–∞—Ç—É—Å —ñ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–æ–∫ –ø—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
async function pollStatus(force){
  try{
    const pid=Number(localStorage.getItem('pid')||0); if(!pid) return;
    const lang=localStorage.getItem('lang')||'ua';
    const d=I18N[lang]||I18N.ua;

    const url=`/api/status?pid=${pid}${force ? ('&nocache='+Date.now()) : ''}`;
    const st=await fetch(url).then(r=>r.json());
    if(!st.ok) return;

    if(st.tg_verified)   disableButton(el.btnTg,   d.tg_subscribed);
    if(st.kick_verified) disableButton(el.btnKick, d.kick_followed);
  }catch(e){}
}
pollStatus(true);
setInterval(pollStatus,3000);

// —è–∫—â–æ –ø–æ–≤–µ—Ä–Ω—É–ª–∏—Å—è –∑ Telegram ‚Äî —Ñ–æ—Ä—Å—É—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —â–µ —Ä–∞–∑
if (document.referrer.includes('t.me') || document.referrer.includes('telegram.me')) {
  setTimeout(()=>pollStatus(true),1500);
}
</script>
</body>
</html>